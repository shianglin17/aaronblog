import{E as S,F as V,D as z,T as B,a as j,d as G,c as H}from"./FormModal-CrkAUENd.js";import{t as E,_ as K}from"./app-B2aNZ5QZ.js";import{r as g,e as Q,c as W,k as X,o as Y,Z,Y as f,W as C,U as q,X as d,S as y,N as e,j as P,a8 as F}from"./vue-vendor-BzR9iUpD.js";import{u as J}from"./ui-vendor-DUNw84bt.js";import"./markdown-j6I5lR1l.js";/* empty css            */function $(m){const c=g([]),s=g(!1),a=g({page:1,per_page:10,search:"",sort_by:"created_at",sort_direction:"desc"}),u=g({currentPage:1,perPage:10,totalItems:0});async function o(){var l;s.value=!0;try{const n=await E.getList();c.value=n.data,(l=n.meta)!=null&&l.pagination&&(u.value={currentPage:n.meta.pagination.current_page,perPage:n.meta.pagination.per_page,totalItems:n.meta.pagination.total_items})}catch(n){m.error(S.FETCH_FAILED),console.error(n)}finally{s.value=!1}}function r(l){a.value.search=l,a.value.page=1,o()}function p(l){a.value.page=l,o()}function v(l){a.value.per_page=l,a.value.page=1,o()}function _(l){l?(a.value.sort_by=l.columnKey,a.value.sort_direction=l.order==="ascend"?"asc":"desc"):(a.value.sort_by="created_at",a.value.sort_direction="desc"),o()}return{tags:c,loading:s,params:a,pagination:u,fetchTags:o,handleSearch:r,handlePageChange:p,handlePageSizeChange:v,handleSorterChange:_}}function ee(m,c){const s={name:"",slug:""},a=Q({...s}),u=g(!1),o=g(!1),r=g(null),p=W(()=>o.value?"編輯標籤":"新增標籤");function v(){Object.assign(a,s),o.value=!1,r.value=null,u.value=!0}function _(n){o.value=!0,r.value=n.id||null,Object.assign(a,{name:n.name,slug:n.slug}),u.value=!0}async function l(n){try{o.value&&r.value?(await E.update({id:r.value,data:n}),m.success("標籤更新成功")):(await E.create(n),m.success("標籤創建成功")),u.value=!1,c()}catch(h){m.error(o.value?S.UPDATE_FAILED:S.CREATE_FAILED),console.error(h)}}return{formModel:a,showForm:u,isEdit:o,editingId:r,formTitle:p,openCreateForm:v,openEditForm:_,handleFormSubmit:l}}function ae(m,c){const s=g(!1),a=g(null);function u(p){a.value=p.id||null,s.value=!0}function o(){a.value=null,s.value=!1}async function r(){if(a.value)try{await E.delete(a.value),m.success("標籤刪除成功"),c()}catch(p){m.error(S.DELETE_FAILED),console.error(p)}finally{a.value=null,s.value=!1}}return{showDeleteConfirm:s,deletingId:a,openDeleteConfirm:u,cancelDelete:o,handleDelete:r}}const ne={class:"page-header"},te=X({__name:"TagManagement",setup(m){const c=J(),s=g(""),{tags:a,loading:u,pagination:o,fetchTags:r,handleSearch:p,handlePageChange:v,handlePageSizeChange:_,handleSorterChange:l}=$(c),{formModel:n,showForm:h,isEdit:w,formTitle:A,openCreateForm:M,openEditForm:U,handleFormSubmit:x}=ee(c,r),{showDeleteConfirm:D,openDeleteConfirm:L,cancelDelete:k,handleDelete:I}=ae(c,r);return Y(()=>{r()}),(oe,t)=>{const R=C("n-button"),T=C("n-input"),b=C("n-form-item"),N=C("n-modal"),O=C("n-message-provider");return q(),Z(O,null,{default:f(()=>[d(H,null,{default:f(()=>[y("div",ne,[t[7]||(t[7]=y("h1",null,"標籤管理",-1)),d(V,{search:s.value,"onUpdate:search":t[0]||(t[0]=i=>s.value=i),onSearch:e(p)},{suffix:f(()=>[d(R,{type:"primary",onClick:e(M)},{default:f(()=>t[6]||(t[6]=[P("新增標籤")])),_:1},8,["onClick"])]),_:1},8,["search","onSearch"]),d(z,{columns:e(B),data:e(a),loading:e(u),pagination:e(o),onPageChange:e(v),onPageSizeChange:e(_),onSorterChange:e(l),onEdit:e(U),onDelete:e(L)},null,8,["columns","data","loading","pagination","onPageChange","onPageSizeChange","onSorterChange","onEdit","onDelete"])]),d(j,{show:e(h),"onUpdate:show":t[3]||(t[3]=i=>F(h)?h.value=i:null),modelValue:e(n),"onUpdate:modelValue":t[4]||(t[4]=i=>F(n)?n.value=i:null),title:e(A),rules:e(G),"submit-text":e(w)?"保存":"新增",onSubmit:e(x)},{default:f(()=>[d(b,{label:"名稱",path:"name"},{default:f(()=>[d(T,{value:e(n).name,"onUpdate:value":t[1]||(t[1]=i=>e(n).name=i),placeholder:"請輸入標籤名稱"},null,8,["value"])]),_:1}),d(b,{label:"Slug",path:"slug"},{default:f(()=>[d(T,{value:e(n).slug,"onUpdate:value":t[2]||(t[2]=i=>e(n).slug=i),placeholder:"請輸入Slug"},null,8,["value"])]),_:1})]),_:1},8,["show","modelValue","title","rules","submit-text","onSubmit"]),d(N,{show:e(D),"onUpdate:show":t[5]||(t[5]=i=>F(D)?D.value=i:null),preset:"dialog",title:"確認刪除","positive-text":"確認","negative-text":"取消",onPositiveClick:e(I),onNegativeClick:e(k)},{default:f(()=>t[8]||(t[8]=[P(" 確定要刪除這個標籤嗎？ ")])),_:1},8,["show","onPositiveClick","onNegativeClick"])]),_:1})]),_:1})}}}),de=K(te,[["__scopeId","data-v-4f25f377"]]);export{de as default};
