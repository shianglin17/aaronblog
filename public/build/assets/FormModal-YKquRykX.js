import{d as T,c as A,o as h,a as m,l as K,r as b,j as y,s as Y,m as J,b as o,g as i,e as r,v as O,h as S,x as z,u as k,f as C,y as H,z as Q,_ as L,B as I,N as X,C as M,D as W,w as R,n as U,E as x,F as Z,S as ee,G as te}from"./app-BT4Ucd5t.js";const ae={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},ne=T({name:"ChevronDownOutline",render:function(_,a){return h(),A("svg",ae,a[0]||(a[0]=[m("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 184l144 144l144-144"},null,-1)]))}}),se={class:"admin-container"},oe={class:"header-content"},re={class:"user-actions"},le={class:"nav-tabs"},ue={class:"user-name"},ie={class:"content-wrapper"},ce=T({__name:"AdminLayout",setup(c){const _=H(),a=Y(),s=K(),l=b(null),d=y(()=>a.path),p=y(()=>[{key:"logout",label:"登出"}]),v=y(()=>""),u=y(()=>{const n=localStorage.getItem("user_data");if(!n)return"";try{return JSON.parse(n).name.charAt(0).toUpperCase()}catch(t){return console.error("解析用戶數據失敗",t),""}});async function e(n){if(n==="logout")try{await Q.logout(),s.success("登出成功"),_.push("/login")}catch(t){s.error("登出失敗"),console.error(t)}}function g(){const n=localStorage.getItem("user_data");if(n)try{l.value=JSON.parse(n)}catch(t){console.error("解析用戶數據失敗",t)}}return J(()=>{g()}),(n,t)=>{const f=i("n-button"),w=i("n-avatar"),E=i("n-icon"),q=i("n-dropdown"),G=i("n-space"),P=i("n-layout-header"),V=i("n-layout-content"),j=i("n-layout");return h(),A("div",se,[o(j,null,{default:r(()=>[o(P,{class:"admin-header"},{default:r(()=>[m("div",oe,[t[6]||(t[6]=m("div",{class:"logo"},[m("h2",null,"Aaron 內容管理")],-1)),m("div",re,[o(G,{size:20,align:"center"},{default:r(()=>[m("div",le,[o(f,{class:O(["nav-tab",{active:d.value==="/admin/articles"}]),quaternary:"",size:"large",onClick:t[0]||(t[0]=N=>n.$router.push("/admin/articles"))},{default:r(()=>t[3]||(t[3]=[S(" 文章管理 ")])),_:1},8,["class"]),o(f,{class:O(["nav-tab",{active:d.value==="/admin/tags"}]),quaternary:"",size:"large",onClick:t[1]||(t[1]=N=>n.$router.push("/admin/tags"))},{default:r(()=>t[4]||(t[4]=[S(" 標籤管理 ")])),_:1},8,["class"]),o(f,{class:O(["nav-tab",{active:d.value==="/admin/categories"}]),quaternary:"",size:"large",onClick:t[2]||(t[2]=N=>n.$router.push("/admin/categories"))},{default:r(()=>t[5]||(t[5]=[S(" 分類管理 ")])),_:1},8,["class"])]),o(q,{options:p.value,onSelect:e,trigger:"click"},{default:r(()=>[o(f,{quaternary:""},{default:r(()=>[o(w,{round:"",size:"small",src:v.value,color:"#8f8072"},{default:r(()=>[S(z(u.value),1)]),_:1},8,["src"]),m("span",ue,z(l.value?l.value.name:"管理員"),1),o(E,null,{default:r(()=>[o(k(ne))]),_:1})]),_:1})]),_:1},8,["options"])]),_:1})])])]),_:1}),o(V,{class:"admin-content"},{default:r(()=>[m("div",ie,[C(n.$slots,"default",{},void 0,!0)])]),_:3})]),_:3})])}}}),ke=L(ce,[["__scopeId","data-v-21fc311b"]]),D={required:!0,message:"此欄位為必填",trigger:["blur","change"]},de=[D,{min:2,max:100,message:"標題長度應為 2-100 個字元",trigger:["blur","change"]}],$=[D,{pattern:/^[a-z0-9-]+$/,message:"Slug 只能包含小寫字母、數字和連字符",trigger:["blur","change"]},{min:3,max:100,message:"Slug 長度應為 3-100 個字元",trigger:["blur","change"]}],B=[{max:255,message:"描述最多 255 個字元",trigger:["blur","change"]}],F=[D,{min:2,max:50,message:"名稱長度應為 2-50 個字元",trigger:["blur","change"]}],ge=[D,{min:10,message:"內容至少需要 10 個字元",trigger:["blur","change"]}],pe=[{type:"number",required:!0,message:"請選擇分類",trigger:["blur","change"]}],me=[{type:"array",message:"請選擇至少一個標籤",trigger:["blur","change"]}],_e=[{type:"string",required:!0,message:"請選擇狀態",trigger:["blur","change"]}],Te=[{title:"標題",key:"title",sorter:!0},{title:"分類",key:"category.name"},{title:"狀態",key:"status"},{title:"建立時間",key:"created_at",sorter:!0}],Re=[{title:"名稱",key:"name",sorter:!0},{title:"Slug",key:"slug"},{title:"描述",key:"description"},{title:"建立時間",key:"created_at",sorter:!0}],Ue=[{title:"名稱",key:"name",sorter:!0},{title:"Slug",key:"slug"},{title:"建立時間",key:"created_at",sorter:!0}],fe=[{label:"全部",value:"all"},{label:"已發布",value:"published"},{label:"草稿",value:"draft"}],he="載入中...",Ae={FETCH_FAILED:"獲取數據失敗，請稍後再試",CREATE_FAILED:"創建失敗，請稍後再試",UPDATE_FAILED:"更新失敗，請稍後再試",DELETE_FAILED:"刪除失敗，請稍後再試"},Le={title:de,slug:$,description:B,content:ge,category_id:pe,status:_e,tags:me},De={name:F,slug:$,description:B},Oe={name:F,slug:$},ve={class:"data-table-wrapper"},ye=T({__name:"DataTable",props:{columns:{type:Array,required:!0},data:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Object,required:!0},showEdit:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0}},emits:["page-change","page-size-change","sorter-change","edit","delete"],setup(c,{emit:_}){const a=c,s=_,l=y(()=>({page:a.pagination.currentPage,pageSize:a.pagination.perPage,showSizePicker:!0,pageSizes:[10,20,50],onChange:e=>s("page-change",e),onUpdatePageSize:e=>s("page-size-change",e),itemCount:a.pagination.totalItems})),d=y(()=>{if(!a.showEdit&&!a.showDelete)return a.columns;const e=[...a.columns];return e.push({title:"操作",key:"actions",width:150,render(g){return I(X,{justify:"center",align:"center"},{default:()=>[a.showEdit?I(M,{size:"small",type:"primary",onClick:()=>s("edit",g)},{default:()=>"編輯"}):null,a.showDelete?I(M,{size:"small",type:"error",onClick:()=>s("delete",g)},{default:()=>"刪除"}):null]})}}),e});function p(e){s("page-change",e)}function v(e){s("page-size-change",e)}function u(e){s("sorter-change",e)}return(e,g)=>(h(),A("div",ve,[o(k(W),{ref:"dataTableRef",loading:c.loading,columns:d.value,data:c.data,pagination:l.value,"loading-text":k(he),"onUpdate:page":p,"onUpdate:pageSize":v,"onUpdate:sorter":u},null,8,["loading","columns","data","pagination","loading-text"])]))}}),Ie=L(ye,[["__scopeId","data-v-8ad66560"]]),Se={class:"filter-bar"},be=T({__name:"FilterBar",props:{showSearch:{type:Boolean,default:!0},showStatus:{type:Boolean,default:!1},search:{type:String,default:""},status:{type:String,default:"all"}},emits:["search","status-change","update:search","update:status"],setup(c,{emit:_}){const a=c,s=_,l=b(a.search),d=b(a.status);R(()=>a.search,u=>{l.value=u}),R(()=>a.status,u=>{d.value=u});function p(){s("update:search",l.value),s("search",l.value)}function v(u){s("update:status",u),s("status-change",u)}return(u,e)=>{const g=i("n-icon"),n=i("n-button"),t=i("n-input"),f=i("n-select"),w=i("n-space");return h(),A("div",Se,[o(w,null,{default:r(()=>[C(u.$slots,"prefix",{},void 0,!0),c.showSearch?(h(),U(t,{key:0,value:l.value,"onUpdate:value":e[0]||(e[0]=E=>l.value=E),placeholder:"搜尋...",clearable:"",onKeyup:Z(p,["enter"])},{suffix:r(()=>[o(n,{quaternary:"",circle:"",onClick:p},{icon:r(()=>[o(g,null,{default:r(()=>[o(k(ee))]),_:1})]),_:1})]),_:1},8,["value"])):x("",!0),c.showStatus?(h(),U(f,{key:1,value:d.value,"onUpdate:value":[e[1]||(e[1]=E=>d.value=E),v],options:k(fe),placeholder:"狀態",clearable:""},null,8,["value","options"])):x("",!0),C(u.$slots,"default",{},void 0,!0),C(u.$slots,"suffix",{},void 0,!0)]),_:3})])}}}),ze=L(be,[["__scopeId","data-v-943a6666"]]),we={class:"form-actions"},Ee=T({__name:"FormModal",props:{title:{type:String,required:!0},width:{type:String,default:"600px"},modelValue:{type:Object,required:!0},rules:{type:Object,default:()=>({})},show:{type:Boolean,default:!1},submitText:{type:String,default:"提交"}},emits:["update:show","update:model-value","submit","cancel"],setup(c,{emit:_}){const a=b(null),s=b(!1),l=b(!1),d=c,p=_;R(()=>d.show,e=>{l.value=e}),R(l,(e,g)=>{e!==d.show&&p("update:show",e),e||setTimeout(()=>{var n;(n=a.value)==null||n.restoreValidation()},0)});async function v(){if(a.value)try{s.value=!0,await a.value.validate(),p("submit",d.modelValue)}catch(e){console.error("表單驗證失敗",e)}finally{s.value=!1}}function u(){l.value=!1,p("cancel")}return(e,g)=>{const n=i("n-button"),t=i("n-form"),f=i("n-modal");return h(),U(f,{show:l.value,"onUpdate:show":g[0]||(g[0]=w=>l.value=w),preset:"card",title:c.title,style:te({width:c.width})},{default:r(()=>[l.value?(h(),U(t,{key:0,ref_key:"formRef",ref:a,model:d.modelValue,rules:c.rules,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging"},{default:r(()=>[C(e.$slots,"default",{},void 0,!0),m("div",we,[o(n,{onClick:u},{default:r(()=>g[1]||(g[1]=[S("取消")])),_:1}),o(n,{type:"primary",loading:s.value,onClick:v},{default:r(()=>[S(z(c.submitText),1)]),_:1},8,["loading"])])]),_:3},8,["model","rules"])):x("",!0)]),_:3},8,["show","title","style"])}}}),xe=L(Ee,[["__scopeId","data-v-0c48ae65"]]);export{Te as A,Re as C,Ie as D,Ae as E,ze as F,fe as S,Ue as T,xe as a,Le as b,ke as c,Oe as d,De as e};
