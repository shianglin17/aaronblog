import{d as k,c as L,o as h,a as _,l as H,r as b,j as v,s as J,m as Q,b as r,g as c,e as l,v as O,h as S,x as z,u as C,f as T,y as X,z as W,_ as D,B as R,N as Z,C as N,D as ee,E as B,F as te,w as U,n as A,G as x,H as ae,S as ne,I as se}from"./app-BB3W57iB.js";const oe={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},re=k({name:"ChevronDownOutline",render:function(d,n){return h(),L("svg",oe,n[0]||(n[0]=[_("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"48",d:"M112 184l144 144l144-144"},null,-1)]))}}),le={class:"admin-container"},ue={class:"header-content"},ie={class:"user-actions"},ce={class:"nav-tabs"},de={class:"user-name"},ge={class:"content-wrapper"},pe=k({__name:"AdminLayout",setup(t){const d=X(),n=J(),o=H(),u=b(null),g=v(()=>n.path),m=v(()=>[{key:"logout",label:"登出"}]),y=v(()=>""),i=v(()=>{const s=localStorage.getItem("user_data");if(!s)return"";try{return JSON.parse(s).name.charAt(0).toUpperCase()}catch(a){return console.error("解析用戶數據失敗",a),""}});async function e(s){if(s==="logout")try{await W.logout(),o.success("登出成功"),d.push("/login")}catch(a){o.error("登出失敗"),console.error(a)}}function p(){const s=localStorage.getItem("user_data");if(s)try{u.value=JSON.parse(s)}catch(a){console.error("解析用戶數據失敗",a)}}return Q(()=>{p()}),(s,a)=>{const f=c("n-button"),w=c("n-avatar"),E=c("n-icon"),P=c("n-dropdown"),V=c("n-space"),j=c("n-layout-header"),K=c("n-layout-content"),Y=c("n-layout");return h(),L("div",le,[r(Y,null,{default:l(()=>[r(j,{class:"admin-header"},{default:l(()=>[_("div",ue,[a[6]||(a[6]=_("div",{class:"logo"},[_("h2",null,"Aaron 內容管理")],-1)),_("div",ie,[r(V,{size:20,align:"center"},{default:l(()=>[_("div",ce,[r(f,{class:O(["nav-tab",{active:g.value==="/admin/articles"}]),quaternary:"",size:"large",onClick:a[0]||(a[0]=M=>s.$router.push("/admin/articles"))},{default:l(()=>a[3]||(a[3]=[S(" 文章管理 ")])),_:1},8,["class"]),r(f,{class:O(["nav-tab",{active:g.value==="/admin/tags"}]),quaternary:"",size:"large",onClick:a[1]||(a[1]=M=>s.$router.push("/admin/tags"))},{default:l(()=>a[4]||(a[4]=[S(" 標籤管理 ")])),_:1},8,["class"]),r(f,{class:O(["nav-tab",{active:g.value==="/admin/categories"}]),quaternary:"",size:"large",onClick:a[2]||(a[2]=M=>s.$router.push("/admin/categories"))},{default:l(()=>a[5]||(a[5]=[S(" 分類管理 ")])),_:1},8,["class"])]),r(P,{options:m.value,onSelect:e,trigger:"click"},{default:l(()=>[r(f,{quaternary:""},{default:l(()=>[r(w,{round:"",size:"small",src:y.value,color:"#8f8072"},{default:l(()=>[S(z(i.value),1)]),_:1},8,["src"]),_("span",de,z(u.value?u.value.name:"管理員"),1),r(E,null,{default:l(()=>[r(C(re))]),_:1})]),_:1})]),_:1},8,["options"])]),_:1})])])]),_:1}),r(K,{class:"admin-content"},{default:l(()=>[_("div",ge,[T(s.$slots,"default",{},void 0,!0)])]),_:3})]),_:3})])}}}),Ue=D(pe,[["__scopeId","data-v-21fc311b"]]),I={required:!0,message:"此欄位為必填",trigger:["blur","change"]},me=[I,{min:2,max:100,message:"標題長度應為 2-100 個字元",trigger:["blur","change"]}],$=[I,{pattern:/^[a-z0-9-]+$/,message:"Slug 只能包含小寫字母、數字和連字符",trigger:["blur","change"]},{min:3,max:100,message:"Slug 長度應為 3-100 個字元",trigger:["blur","change"]}],F=[{max:255,message:"描述最多 255 個字元",trigger:["blur","change"]}],q=[I,{min:2,max:50,message:"名稱長度應為 2-50 個字元",trigger:["blur","change"]}],_e=[I,{min:10,message:"內容至少需要 10 個字元",trigger:["blur","change"]}],fe=[{type:"number",required:!0,message:"請選擇分類",trigger:["blur","change"]}],he=[{type:"array",message:"請選擇至少一個標籤",trigger:["blur","change"]}],ye=[{type:"string",required:!0,message:"請選擇狀態",trigger:["blur","change"]}],G=[{label:"全部",value:"all"},{label:"已發布",value:"published",tagType:"success"},{label:"草稿",value:"draft",tagType:"warning"}];function ve(t){return G.find(d=>d.value===t)}const Ae=[{title:"標題",key:"title",sorter:!0},{title:"分類",key:"category.name"},{title:"狀態",key:"status",render(t){const d=ve(t.status);return!d||!d.tagType?t.status:R(Z,{type:d.tagType},{default:()=>d.label})}},{title:"建立時間",key:"created_at",sorter:!0,render(t){return N(t.created_at)}}],Le=[{title:"名稱",key:"name",sorter:!0},{title:"Slug",key:"slug"},{title:"描述",key:"description"},{title:"建立時間",key:"created_at",sorter:!0,render(t){return N(t.created_at)}}],De=[{title:"名稱",key:"name",sorter:!0},{title:"Slug",key:"slug"},{title:"建立時間",key:"created_at",sorter:!0,render(t){return N(t.created_at)}}],Se="載入中...",Ie={FETCH_FAILED:"獲取數據失敗，請稍後再試",CREATE_FAILED:"創建失敗，請稍後再試",UPDATE_FAILED:"更新失敗，請稍後再試",DELETE_FAILED:"刪除失敗，請稍後再試"},Oe={title:me,slug:$,description:F,content:_e,category_id:fe,status:ye,tags:he},ze={name:q,slug:$,description:F},xe={name:q,slug:$},be={class:"data-table-wrapper"},we=k({__name:"DataTable",props:{columns:{type:Array,required:!0},data:{type:Array,required:!0},loading:{type:Boolean,default:!1},pagination:{type:Object,required:!0},showEdit:{type:Boolean,default:!0},showDelete:{type:Boolean,default:!0}},emits:["page-change","page-size-change","sorter-change","edit","delete"],setup(t,{emit:d}){const n=t,o=d,u=v(()=>({page:n.pagination.currentPage,pageSize:n.pagination.perPage,showSizePicker:!0,pageSizes:[10,20,50],onChange:e=>o("page-change",e),onUpdatePageSize:e=>o("page-size-change",e),itemCount:n.pagination.totalItems})),g=v(()=>{if(!n.showEdit&&!n.showDelete)return n.columns;const e=[...n.columns];return e.push({title:"操作",key:"actions",width:150,render(p){return R(ee,{justify:"center",align:"center"},{default:()=>[n.showEdit?R(B,{size:"small",type:"primary",onClick:()=>o("edit",p)},{default:()=>"編輯"}):null,n.showDelete?R(B,{size:"small",type:"error",onClick:()=>o("delete",p)},{default:()=>"刪除"}):null]})}}),e});function m(e){o("page-change",e)}function y(e){o("page-size-change",e)}function i(e){o("sorter-change",e)}return(e,p)=>(h(),L("div",be,[r(C(te),{ref:"dataTableRef",loading:t.loading,columns:g.value,data:t.data,pagination:u.value,"loading-text":C(Se),"onUpdate:page":m,"onUpdate:pageSize":y,"onUpdate:sorter":i},null,8,["loading","columns","data","pagination","loading-text"])]))}}),Ne=D(we,[["__scopeId","data-v-8ad66560"]]),Ee={class:"filter-bar"},Te=k({__name:"FilterBar",props:{showSearch:{type:Boolean,default:!0},showStatus:{type:Boolean,default:!1},search:{type:String,default:""},status:{type:String,default:"all"}},emits:["search","status-change","update:search","update:status"],setup(t,{emit:d}){const n=t,o=d,u=b(n.search),g=b(n.status);U(()=>n.search,i=>{u.value=i}),U(()=>n.status,i=>{g.value=i});function m(){o("update:search",u.value),o("search",u.value)}function y(i){o("update:status",i),o("status-change",i)}return(i,e)=>{const p=c("n-icon"),s=c("n-button"),a=c("n-input"),f=c("n-select"),w=c("n-space");return h(),L("div",Ee,[r(w,null,{default:l(()=>[T(i.$slots,"prefix",{},void 0,!0),t.showSearch?(h(),A(a,{key:0,value:u.value,"onUpdate:value":e[0]||(e[0]=E=>u.value=E),placeholder:"搜尋...",clearable:"",onKeyup:ae(m,["enter"])},{suffix:l(()=>[r(s,{quaternary:"",circle:"",onClick:m},{icon:l(()=>[r(p,null,{default:l(()=>[r(C(ne))]),_:1})]),_:1})]),_:1},8,["value"])):x("",!0),t.showStatus?(h(),A(f,{key:1,value:g.value,"onUpdate:value":[e[1]||(e[1]=E=>g.value=E),y],options:C(G),placeholder:"狀態",clearable:""},null,8,["value","options"])):x("",!0),T(i.$slots,"default",{},void 0,!0),T(i.$slots,"suffix",{},void 0,!0)]),_:3})])}}}),$e=D(Te,[["__scopeId","data-v-943a6666"]]),Ce={class:"form-actions"},ke=k({__name:"FormModal",props:{title:{type:String,required:!0},width:{type:String,default:"600px"},modelValue:{type:Object,required:!0},rules:{type:Object,default:()=>({})},show:{type:Boolean,default:!1},submitText:{type:String,default:"提交"}},emits:["update:show","update:model-value","submit","cancel"],setup(t,{emit:d}){const n=b(null),o=b(!1),u=b(!1),g=t,m=d;U(()=>g.show,e=>{u.value=e}),U(u,(e,p)=>{e!==g.show&&m("update:show",e),e||setTimeout(()=>{var s;(s=n.value)==null||s.restoreValidation()},0)});async function y(){if(n.value)try{o.value=!0,await n.value.validate(),m("submit",g.modelValue)}catch(e){console.error("表單驗證失敗",e)}finally{o.value=!1}}function i(){u.value=!1,m("cancel")}return(e,p)=>{const s=c("n-button"),a=c("n-form"),f=c("n-modal");return h(),A(f,{show:u.value,"onUpdate:show":p[0]||(p[0]=w=>u.value=w),preset:"card",title:t.title,style:se({width:t.width})},{default:l(()=>[u.value?(h(),A(a,{key:0,ref_key:"formRef",ref:n,model:g.modelValue,rules:t.rules,"label-placement":"left","label-width":"auto","require-mark-placement":"right-hanging"},{default:l(()=>[T(e.$slots,"default",{},void 0,!0),_("div",Ce,[r(s,{onClick:i},{default:l(()=>p[1]||(p[1]=[S("取消")])),_:1}),r(s,{type:"primary",loading:o.value,onClick:y},{default:l(()=>[S(z(t.submitText),1)]),_:1},8,["loading"])])]),_:3},8,["model","rules"])):x("",!0)]),_:3},8,["show","title","style"])}}}),Me=D(ke,[["__scopeId","data-v-0c48ae65"]]);export{Ae as A,Le as C,Ne as D,Ie as E,$e as F,G as S,De as T,Me as a,Oe as b,Ue as c,xe as d,ze as e};
